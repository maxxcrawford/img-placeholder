var CompositeDisposable, ImgPlaceholderView;

ImgPlaceholderView = require('./img-placeholder-view');

CompositeDisposable = require('atom').CompositeDisposable;

module.exports = {
	subscriptions: null,
	activate: function() {
		this.subscriptions = new CompositeDisposable;
		return this.subscriptions.add(atom.commands.add('atom-workspace', {
			'img-placeholder:insert': (function(_this) {
				return function() {
					return _this.insert();
				};
			})(this)
		}));
	},
	deactivate: function() {
		return this.subscriptions.dispose();
	},
	insert: function() {
		var editor, i, letters, placholderText, randomColor;
		editor = atom.workspace.getActiveTextEditor();
		var letters = '0123456789abcdef'.split('');

		var j, results, contrast;
		results = [];
		for (i = j = 0; j <= 5; i = ++j) {
			results.push(letters[Math.floor(Math.random() * 16)]);
		}

		var hexcolor = results.join("");
		var r = parseInt(hexcolor.substr(0, 2), 16);
		var g = parseInt(hexcolor.substr(2, 2), 16);
		var b = parseInt(hexcolor.substr(4, 2), 16);
		var yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
		if (yiq >= 128) {
			contrast = "000000";
		} else {
			contrast = "FFFFFF";
		}

		var colorContrast = hexcolor.toUpperCase() + "/" + contrast;
		return colorContrast;

		placholderText = "<img src='//placehold.it/600x400/" + randomColor + ".png'/>";
		return editor.insertText(placholderText);
	}
};

// ---
// generated by coffee-script 1.9.2
